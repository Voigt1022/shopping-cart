(this["webpackJsonpnew-shopping-cart"]=this["webpackJsonpnew-shopping-cart"]||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(9),i=a.n(r),s=(a(85),a(53)),o=a.n(s),l=a(59),u=a(10),d=a(143),m=a(129),f=a(137),h=a(133),b=a(134),g=a(135),p=a(131),E=a(146),k=a(136),z=["S","M","L","XL"],v=Object(m.a)({outofstockbutton:{width:250,color:"white",backgroundColor:"gray"}}),O=function(e){var t=e.product,a=e.setAnchorEl,n=e.setSelectedsize,r=e.size,i=e.selection,s=v();return 0!==Object.keys(r).length&&0===r[t.sku].S&&0===r[t.sku].M&&0===r[t.sku].L&&0===r[t.sku].XL?c.a.createElement(p.a,{className:s.outofstockbutton,disabled:!0},"Out of Stock"):z.map((function(e){return c.a.createElement(p.a,{key:e,disabled:0===r[t.sku][e]||i.selected.some((function(a){return a.sku===t.sku&&a.size===e&&a[e]>=r[t.sku][e]})),onClick:function(){n(e),a(!1)}},e)}))},j=Object(m.a)({card:{width:350,height:730},root:{display:"flex",flexDirection:"column",alignItems:"center"},addbutton:{backgroundColor:"black",color:"white",width:250,"&:hover":{backgroundColor:"gray"}},size:{width:100,height:36,color:"black","&:hover":{backgroundColor:"white"}},outofstockbutton:{width:250,color:"white",backgroundColor:"gray"}}),w=function(e){var t=e.product,a=e.drawerstate,r=e.selection,i=e.size,s=e.user,o=Object(n.useState)(!1),l=Object(u.a)(o,2),d=l[0],m=l[1],f=Object(n.useState)(""),z=Object(u.a)(f,2),v=z[0],w=z[1],S=Object(n.useRef)(),C=j(),x=function(e,t){switch(t){case"BRL":return e.toFixed(2).replace(".",",");default:return e.toFixed(2)}}(t.price,t.currencyId);return c.a.createElement(h.a,{variant:"outlined",className:C.card},c.a.createElement("h2",{"margin-block":"0"},t.title),c.a.createElement(b.a,{component:"img",image:"data/products/"+t.sku+"_1.jpg"}),c.a.createElement(g.a,null,c.a.createElement("big",null,'"',t.description,'"')),c.a.createElement(g.a,{align:"center"},c.a.createElement("small",null,t.currencyFormat+" "),c.a.createElement("big",null,x.substr(0,x.length-3)),c.a.createElement("small",null,x.substr(x.length-3,3))),c.a.createElement(k.a,null),c.a.createElement("div",{className:C.root},c.a.createElement(p.a,{className:C.size,ref:S,onClick:function(){return m(!0)}},v),c.a.createElement(E.a,{open:d,anchorEl:S.current,onClose:function(){m(!1)},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},c.a.createElement(O,{product:t,setAnchorEl:m,setSelectedsize:w,size:i,selection:r})),c.a.createElement(p.a,{className:C.addbutton,disabled:""!==v&&0===i[t.sku][v]||r.selected.some((function(e){return e.sku===t.sku&&e.size===v&&e[v]>=i[t.sku][v]})),onClick:function(){""===v?m(!0):(a.setState(!0),r.addToggle(t,v,s))}},"Pick Size & Add to Cart")))},S=Object(m.a)({root:{margin:10}}),C=function(e){var t=e.products,a=e.drawerstate,n=e.selection,r=e.size,i=e.user,s=S();return c.a.createElement(f.a,{container:!0,className:s.root,spacing:3},t.map((function(e){return c.a.createElement(f.a,{item:!0,key:e.sku},c.a.createElement(w,{product:e,drawerstate:a,selection:n,size:r,user:i}))})))},x=a(141),y=a(142),N=a(145),T=a(139),I=a(46),L=a.n(I),A=a(140),F=a(67),D=a.n(F),R=a(22),W=a(39),B=a(40),M=a(64),P=a.n(M),$=a(138),G=a(65),K=a.n(G),_=a(66),q=a.n(_),J=a(3),V=a.n(J),X=(a(31),Object(m.a)({shoppinglist:{height:function(e){return e.height-190},overflow:"auto"},card:{display:"flex"},cardcontent:{display:"flex",flexDirection:"column",minWidth:200},cardmedia:{width:49.5,height:72,marginTop:18,marginLeft:5},clearbutton:{display:"flex",flexDirection:"column",marginTop:15,marginLeft:60},adjustbutton:{display:"flex",flexDirection:"row",marginTop:45,marginLeft:-26},checkoutbuttonself:{marginTop:10,fontSize:20,width:250,backgroundColor:function(e){return e.totalCost?"black":"white"},color:"white","&:hover":{backgroundColor:"black"}}})),H=function(e){var t=e.selection,a=e.size,r=e.user,i=e.height,s=0;t.selected.length>=1&&t.selected.forEach((function(e){return s+=e[e.size]*e.price}));var o=X({totalCost:s,height:i});return Object(n.useEffect)((function(){t.selected.forEach((function(e){0===a[e.sku][e.size]?(alert("The item ".concat(e.title," you selected is unavailable, please remove it")),e[e.size]=0):e[e.size]>a[e.sku][e.size]&&(alert("The amount of the item ".concat(e.title," you selected exceeds the available amount, because someone bought it, so it is adjusted to the maximum amount.")),e[e.size]=a[e.sku][e.size])})),r&&V.a.database().ref().child("carts/"+r.uid).set(t.selected),t.setSelected(Object(B.a)(t.selected))}),[a.checkout]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:o.shoppinglist},t.selected.map((function(e){return c.a.createElement(h.a,{key:e.sku+e.size,className:o.card},c.a.createElement(b.a,{className:o.cardmedia,component:"img",image:"data/products/"+e.sku+"_1.jpg",alt:"product image"}),c.a.createElement($.a,{className:o.cardcontent},c.a.createElement(g.a,{variant:"subtitle2"},e.title),c.a.createElement(g.a,{variant:"caption"},"$ ",e.price.toFixed(2)," | size: ",e.size),c.a.createElement(g.a,{variant:"caption"},"Quantity: ",e[e.size]),c.a.createElement(g.a,{variant:"caption"},"Price: $ ",(e.price*e[e.size]).toFixed(2))),c.a.createElement("div",{className:o.clearbutton},c.a.createElement(T.a,{size:"small",onClick:function(){return t.deleteToggle(e,e.size,r)}},c.a.createElement(P.a,{fontSize:"small"})),c.a.createElement("div",{className:o.adjustbutton},c.a.createElement(T.a,{className:o.addbutton,size:"small",disabled:e[e.size]>=a[e.sku][e.size],onClick:function(){return t.addToggle(e,e.size,r)}},c.a.createElement(K.a,{fontSize:"small"})),c.a.createElement(T.a,{size:"small",disabled:e[e.size]<=1,onClick:function(){return t.decreaseToggle(e,e.size,r)}},c.a.createElement(q.a,{fontSize:"small"})))))}))),c.a.createElement(k.a,null),c.a.createElement("div",{align:"center"},c.a.createElement(g.a,{variant:"h6"},"$",s.toFixed(2)),c.a.createElement(p.a,{disabled:0===s,className:o.checkoutbuttonself,onClick:function(){alert("Subtotal: $ ".concat(s.toFixed(2))),t.selected.forEach((function(e){V.a.database().ref().child(e.sku).transaction((function(t){return Object(W.a)({},t,Object(R.a)({},e.size,a[e.sku][e.size]-e[e.size]))}))})),t.setSelected([]),r&&V.a.database().ref().child("carts/"+r.uid).set([]),V.a.database().ref().child("checkout").transaction((function(e){return!e}))}},"Checkout")))},Q=Object(m.a)({list:{width:380},cartbutton:{color:"black"}}),U=function(e){var t=e.drawerstate,a=e.selection,n=e.size,r=e.user,i=e.totalNum,s=e.height,o=Q(s);return c.a.createElement("div",{className:o.list},c.a.createElement(f.a,{container:!0},c.a.createElement(f.a,{item:!0,xs:5},c.a.createElement(T.a,{onClick:function(){return t.setState(!1)},"aira-label":"close shopping cart"},c.a.createElement(D.a,{fontSize:"large"}))),c.a.createElement(f.a,{item:!0,xs:7},c.a.createElement(T.a,{"aira-label":"shopping cart",disabled:!0},c.a.createElement(A.a,{badgeContent:i,color:"secondary"},c.a.createElement(L.a,{className:o.cartbutton,fontSize:"large"}))))),c.a.createElement(k.a,null),c.a.createElement(H,{selection:a,size:n,user:r,height:s}))},Y=function(e){var t=e.drawerstate,a=e.selection,r=e.size,i=e.user,s=function(){var e=Object(n.useState)([0,0]),t=Object(u.a)(e,2),a=t[0],c=t[1];return Object(n.useLayoutEffect)((function(){function e(){c([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),a}(),o=Object(u.a)(s,2),l=(o[0],o[1]),d=0;return a.selected.length>=1&&a.selected.forEach((function(e){return d+=e[e.size]})),c.a.createElement("div",null,c.a.createElement(T.a,{onClick:function(){return t.setState(!0)}},c.a.createElement(A.a,{badgeContent:d,color:"black"},c.a.createElement(L.a,{fontSize:"large"}))),c.a.createElement(N.a,{anchor:"right",open:t.state},c.a.createElement(U,{drawerstate:t,selection:a,size:r,user:i,totalNum:d,height:l})))},Z=(a(33),a(68)),ee=a.n(Z),te=Object(m.a)({popover:{marginTop:5,marginLeft:-120}}),ae={signInFlow:"popup",signInOptions:[V.a.auth.GoogleAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:function(){return!1}}},ne=function(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0],r=t[1],i=Object(n.useRef)(),s=te();return c.a.createElement(c.a.Fragment,null,c.a.createElement(p.a,{ref:i,color:"black",size:"large",onClick:function(){return r(!0)}},"Log in"),c.a.createElement(E.a,{className:s.popover,open:a,anchorEl:i.current,onClose:function(){return r(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},c.a.createElement(ee.a,{uiConfig:ae,firebaseAuth:V.a.auth()})))},ce=function(e){var t=e.selection,a=e.size,r=e.user,i=Object(n.useState)(!1),s=Object(u.a)(i,2),o=s[0],l=s[1],d=Object(n.useRef)();return Object(n.useEffect)((function(){!function(){if(a.carts)if(a.carts.hasOwnProperty(r.uid)){var e=a.carts[r.uid],n=[];if(e.forEach((function(e){var c=t.selected.findIndex((function(t){return t.sku===e.sku&&t.size===e.size}));-1!==c?t.selected[c][e.size]+e[e.size]>a[e.sku][e.size]?(0===a[e.sku][e.size]?alert("The item ".concat(e.title," you selected is unavailable, please remove it")):alert("The amount of the item ".concat(e.title," you selected before log in and in your accout exceeds the available amount, so it is adjusted to the maximum amount.")),t.selected[c][e.size]=a[e.sku][e.size]):t.selected[c][e.size]=t.selected[c][e.size]+e[e.size]:n=n.concat([e])})),n.length>=1){var c=t.selected.concat(n);t.setSelected(c),V.a.database().ref().child("carts/"+r.uid).set(c)}else t.setSelected(t.selected),V.a.database().ref().child("carts/"+r.uid).set(t.selected)}else V.a.database().ref().child("carts/"+r.uid).set(t.selected);else 0!==Object.keys(a).length&&V.a.database().ref().child("carts/"+r.uid).set(t.selected)}()}),[r]),c.a.createElement(c.a.Fragment,null,c.a.createElement(p.a,{ref:d,color:"black",size:"large",onClick:function(){return l(!0)}},r.displayName),c.a.createElement(E.a,{open:o,anchorEl:d.current,onClose:function(){return l(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},c.a.createElement(p.a,{color:"inherit",onClick:function(){V.a.auth().signOut(),t.setSelected([])}},"Log out")))},re=Object(m.a)({appbar:{backgroundColor:"white"},title:{flexGrow:1}}),ie=function(e){var t=e.drawerstate,a=e.selection,n=e.size,r=e.user,i=re();return c.a.createElement(x.a,{className:i.appbar,position:"static"},c.a.createElement(y.a,null,c.a.createElement("a",{href:"https://github.com/Voigt1022/shopping-cart"},c.a.createElement("img",{src:"data/github.svg",height:"30",width:"30"})),r?c.a.createElement(ce,{selection:a,size:n,user:r}):c.a.createElement(ne,null),c.a.createElement(g.a,{className:i.title}),c.a.createElement(Y,{drawerstate:t,selection:a,size:n,user:r})))};V.a.initializeApp({apiKey:"AIzaSyA9YK868AqmkMnyzengqpjAD5C0KdwhW58",authDomain:"desk-fdcd0.firebaseapp.com",databaseURL:"https://desk-fdcd0.firebaseio.com",projectId:"desk-fdcd0",storageBucket:"desk-fdcd0.appspot.com",messagingSenderId:"627222503043",appId:"1:627222503043:web:c62a6ec2fc74850afb45b6",measurementId:"G-ZB16M0N4NG"});var se=V.a,oe=se.database().ref(),le=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],c=t[1];return[a,c,function(e,t,n){if(a.some((function(a){return a.sku===e.sku&&a.size===t}))){var r=a.findIndex((function(a){return a.sku===e.sku&&a.size===t}));a[r]=Object(W.a)({},a[r],Object(R.a)({},t,a[r][t]+1)),c(Object(B.a)(a)),n&&oe.child("carts/"+n.uid).set(a)}else{var i=Object(R.a)({size:t},t,1),s=a.concat([Object.assign(i,e)]);c(s),n&&oe.child("carts/"+n.uid).set(s)}},function(e,t,n){var r=a.filter((function(a){return a.sku!==e.sku||a.size!==t}));c(r),n&&oe.child("carts/"+n.uid).set(r)},function(e,t,n){var r=a.findIndex((function(a){return a.sku===e.sku&&a.size===t}));a[r][t]>1&&(a[r]=Object(W.a)({},a[r],Object(R.a)({},t,a[r][t]-1)),c(Object(B.a)(a)),n&&oe.child("carts/"+n.uid).set(a))}]},ue=se.database().ref(),de=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],r=t[1],i=Object(n.useState)(!1),s=Object(u.a)(i,2),m=s[0],f=s[1],h=le(),b=Object(u.a)(h,5),g=b[0],p=b[1],E=b[2],k=b[3],z=b[4],v=Object(n.useState)({}),O=Object(u.a)(v,2),j=O[0],w=O[1],S=Object(n.useState)(null),x=Object(u.a)(S,2),y=x[0],N=x[1];return Object(n.useEffect)((function(){se.auth().onAuthStateChanged(N)}),[]),Object(n.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./data/products.json");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,r(Object.values(a));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(n.useEffect)((function(){var e=function(e){e.val()&&w(e.val())};return ue.on("value",e,(function(e){return alert(e)})),function(){ue.off("value",e)}}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(ie,{drawerstate:{state:m,setState:f},selection:{selected:g,setSelected:p,addToggle:E,deleteToggle:k,decreaseToggle:z},size:j,user:y}),c.a.createElement(d.a,{maxWidth:"xl"},c.a.createElement(C,{products:a,drawerstate:{state:m,setState:f},selection:{selected:g,addToggle:E},size:j,user:y})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(de,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},80:function(e,t,a){e.exports=a(102)},85:function(e,t,a){}},[[80,1,2]]]);
//# sourceMappingURL=main.22d06a05.chunk.js.map